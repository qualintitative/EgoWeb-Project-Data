---
title: 'Replication Code for PONE-D-19-36073R1
#"Restructuring personal networks with a Motivational Interviewing social network intervention to assist the transition out of homelessness: a randomized control pilot study'
output: html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

***

Read in the .csv data for analysis

```{r, error=TRUE}
library(tidyr)
library(dplyr)
library(nlme)

#read in MyData_po.csv from where it is currently saved
MyData <- read.csv(file.choose(), header=TRUE)

```



##Create a non-response variable

```{r}
MyData$alters.b<-as.numeric(as.character(MyData$alters.b))
MyData$alters.f<-as.numeric(as.character(MyData$alters.f))
MyData$total_drinks_4weeks.b<-as.numeric(as.character(MyData$total_drinks_4weeks.b))
MyData$total_drinks_4weeks.f<-as.numeric(as.character(MyData$total_drinks_4weeks.f))
MyData$daysbinge.b<-as.numeric(as.character(MyData$daysbinge.b))
MyData$daysbinge.f<-as.numeric(as.character(MyData$daysbinge.f))
MyData$daysmj.b<-as.numeric(as.character(MyData$daysmj.b))
MyData$daysmj.f<-as.numeric(as.character(MyData$daysmj.f))
MyData$days.drugs.all.b<-as.numeric(as.character(MyData$days.drugs.all.b))
MyData$days.drugs.all.f<-as.numeric(as.character(MyData$days.drugs.all.f))
MyData$RTCSU.sum.all.b<-as.numeric(as.character(MyData$RTCSU.sum.all.b))
MyData$RTCSU.sum.all.f<-as.numeric(as.character(MyData$RTCSU.sum.all.f))

MyData$prop.drink.with.b                         <-as.numeric(as.character(MyData$prop.drink.with.b))
MyData$prop.drink.with.recent.b                  <-as.numeric(as.character(MyData$prop.drink.with.recent.b))
MyData$prop.drugs.with.b                         <-as.numeric(as.character(MyData$prop.drugs.with.b))
MyData$prop.drugs.with.recent.b                  <-as.numeric(as.character(MyData$prop.drugs.with.recent.b))
MyData$prop.aod.more.with.b                      <-as.numeric(as.character(MyData$prop.aod.more.with.b))
MyData$prop.aod.more.with.recent.b               <-as.numeric(as.character(MyData$prop.aod.more.with.recent.b))
MyData$prop.any.risk.b                           <-as.numeric(as.character(MyData$prop.any.risk.b))
MyData$prop.any.risk.recent.b                    <-as.numeric(as.character(MyData$prop.any.risk.recent.b))
MyData$prop.em.support.b                         <-as.numeric(as.character(MyData$prop.em.support.b))
MyData$prop.em.support.recent.b                  <-as.numeric(as.character(MyData$prop.em.support.recent.b))
MyData$prop.info.support.b                       <-as.numeric(as.character(MyData$prop.info.support.b))
MyData$prop.info.support.recent.b                <-as.numeric(as.character(MyData$prop.info.support.recent.b))
MyData$prop.tan.support.b                        <-as.numeric(as.character(MyData$prop.tan.support.b))
MyData$prop.tan.support.recent.b                 <-as.numeric(as.character(MyData$prop.tan.support.recent.b))
MyData$prop.any.support.b                        <-as.numeric(as.character(MyData$prop.any.support.b))
MyData$prop.any.support.recent.b                 <-as.numeric(as.character(MyData$prop.any.support.recent.b))
MyData$ave.negative.rel.b                        <-as.numeric(as.character(MyData$ave.negative.rel.b))
MyData$prop.time.spend.more.b                    <-as.numeric(as.character(MyData$prop.time.spend.more.b))
MyData$prop.time.spend.more.or.same.b            <-as.numeric(as.character(MyData$prop.time.spend.more.or.same.b))
MyData$prop.time.spend.less.b                    <-as.numeric(as.character(MyData$prop.time.spend.less.b))
MyData$prop.time.spend.same.b                    <-as.numeric(as.character(MyData$prop.time.spend.same.b))
MyData$prop.risk.and.support.b                   <-as.numeric(as.character(MyData$prop.risk.and.support.b))
MyData$prop.risk.not.support.b                   <-as.numeric(as.character(MyData$prop.risk.not.support.b))
MyData$prop.support.not.risk.b                   <-as.numeric(as.character(MyData$prop.support.not.risk.b))
MyData$prop.risk.and.support.recent.b            <-as.numeric(as.character(MyData$prop.risk.and.support.recent.b))
MyData$prop.risk.not.support.recent.b            <-as.numeric(as.character(MyData$prop.risk.not.support.recent.b))
MyData$prop.support.not.risk.recent.b            <-as.numeric(as.character(MyData$prop.support.not.risk.recent.b))
MyData$ave.risk.degree_w.b                       <-as.numeric(as.character(MyData$ave.risk.degree_w.b))
MyData$ave.risk.degree_m.b                       <-as.numeric(as.character(MyData$ave.risk.degree_m.b))
MyData$ave.risk.degree_s.b                       <-as.numeric(as.character(MyData$ave.risk.degree_s.b))
MyData$ave.risk.recent.degree_w.b                <-as.numeric(as.character(MyData$ave.risk.recent.degree_w.b))
MyData$ave.risk.recent.degree_m.b                <-as.numeric(as.character(MyData$ave.risk.recent.degree_m.b))
MyData$ave.risk.recent.degree_s.b                <-as.numeric(as.character(MyData$ave.risk.recent.degree_s.b))
MyData$ave.support.degree_w.b                    <-as.numeric(as.character(MyData$ave.support.degree_w.b))
MyData$ave.support.degree_m.b                    <-as.numeric(as.character(MyData$ave.support.degree_m.b))
MyData$ave.support.degree_s.b                    <-as.numeric(as.character(MyData$ave.support.degree_s.b))
MyData$ave.support.recent.degree_w.b             <-as.numeric(as.character(MyData$ave.support.recent.degree_w.b))
MyData$ave.support.recent.degree_m.b             <-as.numeric(as.character(MyData$ave.support.recent.degree_m.b))
MyData$ave.support.recent.degree_s.b             <-as.numeric(as.character(MyData$ave.support.recent.degree_s.b))




MyData$prop.drink.with.f                         <-as.numeric(as.character(MyData$prop.drink.with.f))
MyData$prop.drink.with.recent.f                  <-as.numeric(as.character(MyData$prop.drink.with.recent.f))
MyData$prop.drugs.with.f                         <-as.numeric(as.character(MyData$prop.drugs.with.f))
MyData$prop.drugs.with.recent.f                  <-as.numeric(as.character(MyData$prop.drugs.with.recent.f))
MyData$prop.aod.more.with.f                      <-as.numeric(as.character(MyData$prop.aod.more.with.f))
MyData$prop.aod.more.with.recent.f               <-as.numeric(as.character(MyData$prop.aod.more.with.recent.f))
MyData$prop.any.risk.f                           <-as.numeric(as.character(MyData$prop.any.risk.f))
MyData$prop.any.risk.recent.f                    <-as.numeric(as.character(MyData$prop.any.risk.recent.f))
MyData$prop.em.support.f                         <-as.numeric(as.character(MyData$prop.em.support.f))
MyData$prop.em.support.recent.f                  <-as.numeric(as.character(MyData$prop.em.support.recent.f))
MyData$prop.info.support.f                       <-as.numeric(as.character(MyData$prop.info.support.f))
MyData$prop.info.support.recent.f                <-as.numeric(as.character(MyData$prop.info.support.recent.f))
MyData$prop.tan.support.f                        <-as.numeric(as.character(MyData$prop.tan.support.f))
MyData$prop.tan.support.recent.f                 <-as.numeric(as.character(MyData$prop.tan.support.recent.f))
MyData$prop.any.support.f                        <-as.numeric(as.character(MyData$prop.any.support.f))
MyData$prop.any.support.recent.f                 <-as.numeric(as.character(MyData$prop.any.support.recent.f))
MyData$ave.negative.rel.f                        <-as.numeric(as.character(MyData$ave.negative.rel.f))
MyData$prop.time.spend.more.f                    <-as.numeric(as.character(MyData$prop.time.spend.more.f))
MyData$prop.time.spend.more.or.same.f            <-as.numeric(as.character(MyData$prop.time.spend.more.or.same.f))
MyData$prop.time.spend.less.f                    <-as.numeric(as.character(MyData$prop.time.spend.less.f))
MyData$prop.time.spend.same.f                    <-as.numeric(as.character(MyData$prop.time.spend.same.f))
MyData$prop.risk.and.support.f                   <-as.numeric(as.character(MyData$prop.risk.and.support.f))
MyData$prop.risk.not.support.f                   <-as.numeric(as.character(MyData$prop.risk.not.support.f))
MyData$prop.support.not.risk.f                   <-as.numeric(as.character(MyData$prop.support.not.risk.f))
MyData$prop.risk.and.support.recent.f            <-as.numeric(as.character(MyData$prop.risk.and.support.recent.f))
MyData$prop.risk.not.support.recent.f            <-as.numeric(as.character(MyData$prop.risk.not.support.recent.f))
MyData$prop.support.not.risk.recent.f            <-as.numeric(as.character(MyData$prop.support.not.risk.recent.f))
MyData$ave.risk.degree_w.f                       <-as.numeric(as.character(MyData$ave.risk.degree_w.f))
MyData$ave.risk.degree_m.f                       <-as.numeric(as.character(MyData$ave.risk.degree_m.f))
MyData$ave.risk.degree_s.f                       <-as.numeric(as.character(MyData$ave.risk.degree_s.f))
MyData$ave.risk.recent.degree_w.f                <-as.numeric(as.character(MyData$ave.risk.recent.degree_w.f))
MyData$ave.risk.recent.degree_m.f                <-as.numeric(as.character(MyData$ave.risk.recent.degree_m.f))
MyData$ave.risk.recent.degree_s.f                <-as.numeric(as.character(MyData$ave.risk.recent.degree_s.f))
MyData$ave.support.degree_w.f                    <-as.numeric(as.character(MyData$ave.support.degree_w.f))
MyData$ave.support.degree_m.f                    <-as.numeric(as.character(MyData$ave.support.degree_m.f))
MyData$ave.support.degree_s.f                    <-as.numeric(as.character(MyData$ave.support.degree_s.f))
MyData$ave.support.recent.degree_w.f             <-as.numeric(as.character(MyData$ave.support.recent.degree_w.f))
MyData$ave.support.recent.degree_m.f             <-as.numeric(as.character(MyData$ave.support.recent.degree_m.f))
MyData$ave.support.recent.degree_s.f             <-as.numeric(as.character(MyData$ave.support.recent.degree_s.f))

#### add in churn variables


MyData$dropped.alter.tot                         <-as.numeric(as.character(MyData$dropped.alter.tot                          ))
MyData$new.alter.tot                             <-as.numeric(as.character(MyData$new.alter.tot                              ))
MyData$retained.alter.tot                        <-as.numeric(as.character(MyData$retained.alter.tot                         ))
MyData$stop.drink.tot                            <-as.numeric(as.character(MyData$stop.drink.tot                             ))
MyData$stop.drug.tot                             <-as.numeric(as.character(MyData$stop.drug.tot                              ))
MyData$stop.aod.more.tot                         <-as.numeric(as.character(MyData$stop.aod.more.tot                          ))
MyData$stop.any.risk.tot                         <-as.numeric(as.character(MyData$stop.any.risk.tot                          ))
MyData$start.drink.tot                           <-as.numeric(as.character(MyData$start.drink.tot                            ))
MyData$start.drug.tot                            <-as.numeric(as.character(MyData$start.drug.tot                             ))
MyData$start.aod.more.tot                        <-as.numeric(as.character(MyData$start.aod.more.tot                         ))
MyData$start.any.risk.tot                        <-as.numeric(as.character(MyData$start.any.risk.tot                         ))
MyData$maintain.drink.tot                        <-as.numeric(as.character(MyData$maintain.drink.tot                         ))
MyData$maintain.drug.tot                         <-as.numeric(as.character(MyData$maintain.drug.tot                          ))
MyData$maintain.aod.more.tot                     <-as.numeric(as.character(MyData$maintain.aod.more.tot                      ))
MyData$maintain.any.risk.tot                     <-as.numeric(as.character(MyData$maintain.any.risk.tot                      ))
MyData$former.drink.tot                          <-as.numeric(as.character(MyData$former.drink.tot                           ))
MyData$former.drug.tot                           <-as.numeric(as.character(MyData$former.drug.tot                            ))
MyData$former.aod.more.tot                       <-as.numeric(as.character(MyData$former.aod.more.tot                        ))
MyData$former.any.risk.tot                       <-as.numeric(as.character(MyData$former.any.risk.tot                        ))
MyData$new.drink.tot                             <-as.numeric(as.character(MyData$new.drink.tot                              ))
MyData$new.drug.tot                              <-as.numeric(as.character(MyData$new.drug.tot                               ))
MyData$new.aod.more.tot                          <-as.numeric(as.character(MyData$new.aod.more.tot                           ))
MyData$new.any.risk.tot                          <-as.numeric(as.character(MyData$new.any.risk.tot                           ))
MyData$stop.em.support.tot                       <-as.numeric(as.character(MyData$stop.em.support.tot                        ))
MyData$stop.info.support.tot                     <-as.numeric(as.character(MyData$stop.info.support.tot                      ))
MyData$stop.tan.support.tot                      <-as.numeric(as.character(MyData$stop.tan.support.tot                       ))
MyData$stop.any.support.tot                      <-as.numeric(as.character(MyData$stop.any.support.tot                       ))
MyData$start.em.support.tot                      <-as.numeric(as.character(MyData$start.em.support.tot                       ))
MyData$start.info.support.tot                    <-as.numeric(as.character(MyData$start.info.support.tot                     ))
MyData$start.tan.support.tot                     <-as.numeric(as.character(MyData$start.tan.support.tot                      ))
MyData$start.any.support.tot                     <-as.numeric(as.character(MyData$start.any.support.tot                      ))
MyData$maintain.em.support.tot                   <-as.numeric(as.character(MyData$maintain.em.support.tot                    ))
MyData$maintain.info.support.tot                 <-as.numeric(as.character(MyData$maintain.info.support.tot                  ))
MyData$maintain.aod.more.tot                     <-as.numeric(as.character(MyData$maintain.aod.more.tot                      ))
MyData$maintain.any.risk.tot                     <-as.numeric(as.character(MyData$maintain.any.risk.tot                      ))
MyData$new.em.support.tot                        <-as.numeric(as.character(MyData$new.em.support.tot                         ))
MyData$new.info.support.tot                      <-as.numeric(as.character(MyData$new.info.support.tot                       ))
MyData$new.tan.support.tot                       <-as.numeric(as.character(MyData$new.tan.support.tot                        ))
MyData$new.any.support.tot                       <-as.numeric(as.character(MyData$new.any.support.tot                        ))
MyData$former.em.support.tot                     <-as.numeric(as.character(MyData$former.em.support.tot                      ))
MyData$former.info.support.tot                   <-as.numeric(as.character(MyData$former.info.support.tot                    ))
MyData$former.tan.support.tot                    <-as.numeric(as.character(MyData$former.tan.support.tot                     ))
MyData$former.any.support.tot                    <-as.numeric(as.character(MyData$former.any.support.tot                     ))
MyData$stop.risk.and.support.tot                 <-as.numeric(as.character(MyData$stop.risk.and.support.tot                  ))
MyData$stop.risk.not.support.tot                 <-as.numeric(as.character(MyData$stop.risk.not.support.tot                  ))
MyData$stop.support.not.risk.tot                 <-as.numeric(as.character(MyData$stop.support.not.risk.tot                  ))
MyData$stop.risk.and.support.recent.tot          <-as.numeric(as.character(MyData$stop.risk.and.support.recent.tot           ))
MyData$stop.risk.not.support.recent.tot          <-as.numeric(as.character(MyData$stop.risk.not.support.recent.tot           ))
MyData$stop.support.not.risk.recent.tot          <-as.numeric(as.character(MyData$stop.support.not.risk.recent.tot           ))
MyData$start.risk.and.support.tot                <-as.numeric(as.character(MyData$start.risk.and.support.tot                 ))
MyData$start.risk.not.support.tot                <-as.numeric(as.character(MyData$start.risk.not.support.tot                 ))
MyData$start.support.not.risk.tot                <-as.numeric(as.character(MyData$start.support.not.risk.tot                 ))
MyData$start.risk.and.support.recent.tot         <-as.numeric(as.character(MyData$start.risk.and.support.recent.tot          ))
MyData$start.risk.not.support.recent.tot         <-as.numeric(as.character(MyData$start.risk.not.support.recent.tot          ))
MyData$start.support.not.risk.recent.tot         <-as.numeric(as.character(MyData$start.support.not.risk.recent.tot          ))
MyData$maintain.risk.and.support.tot             <-as.numeric(as.character(MyData$maintain.risk.and.support.tot              ))
MyData$maintain.risk.not.support.tot             <-as.numeric(as.character(MyData$maintain.risk.not.support.tot              ))
MyData$maintain.support.not.risk.tot             <-as.numeric(as.character(MyData$maintain.support.not.risk.tot              ))
MyData$maintain.risk.and.support.recent.tot      <-as.numeric(as.character(MyData$maintain.risk.and.support.recent.tot       ))
MyData$maintain.risk.not.support.recent.tot      <-as.numeric(as.character(MyData$maintain.risk.not.support.recent.tot       ))
MyData$maintain.support.not.risk.recent.tot      <-as.numeric(as.character(MyData$maintain.support.not.risk.recent.tot       ))
MyData$new.risk.and.support.tot                  <-as.numeric(as.character(MyData$new.risk.and.support.tot                   ))
MyData$new.risk.not.support.tot                  <-as.numeric(as.character(MyData$new.risk.not.support.tot                   ))
MyData$new.support.not.risk.tot                  <-as.numeric(as.character(MyData$new.support.not.risk.tot                   ))
MyData$new.risk.and.support.recent.tot           <-as.numeric(as.character(MyData$new.risk.and.support.recent.tot            ))
MyData$new.risk.not.support.recent.tot           <-as.numeric(as.character(MyData$new.risk.not.support.recent.tot            ))
MyData$new.support.not.risk.recent.tot           <-as.numeric(as.character(MyData$new.support.not.risk.recent.tot            ))
MyData$former.risk.and.support.tot               <-as.numeric(as.character(MyData$former.risk.and.support.tot                ))
MyData$former.risk.not.support.tot               <-as.numeric(as.character(MyData$former.risk.not.support.tot                ))
MyData$former.support.not.risk.tot               <-as.numeric(as.character(MyData$former.support.not.risk.tot                ))
MyData$former.risk.and.support.recent.tot        <-as.numeric(as.character(MyData$former.risk.and.support.recent.tot         ))
MyData$former.risk.not.support.recent.tot        <-as.numeric(as.character(MyData$former.risk.not.support.recent.tot         ))
MyData$former.support.not.risk.recent.tot        <-as.numeric(as.character(MyData$former.support.not.risk.recent.tot         ))
MyData$alters                                    <-as.numeric(as.character(MyData$alters                                     ))
MyData$alters.f                                  <-as.numeric(as.character(MyData$alters.f                                   ))
MyData$alters.b                                  <-as.numeric(as.character(MyData$alters.b                                   ))

#Add in structure variables
MyData$density_weak.b                            <-as.numeric(as.character(MyData$density_weak.b                                   ))
MyData$density_medium.b                          <-as.numeric(as.character(MyData$density_medium.b                                   ))
MyData$density_strong.b                          <-as.numeric(as.character(MyData$density_strong.b                                   ))
MyData$density_weak.f                            <-as.numeric(as.character(MyData$density_weak.f                                   ))
MyData$density_medium.f                          <-as.numeric(as.character(MyData$density_medium.f                                   ))
MyData$density_strong.f                          <-as.numeric(as.character(MyData$density_strong.f                                   ))

MyData$components_weak.b                         <-as.numeric(as.character(MyData$components_weak.b                                   ))
MyData$components_medium.b                       <-as.numeric(as.character(MyData$components_medium.b                                   ))
MyData$components_strong.b                       <-as.numeric(as.character(MyData$components_strong.b                                   ))
MyData$components_weak.f                         <-as.numeric(as.character(MyData$components_weak.f                                   ))
MyData$components_medium.f                       <-as.numeric(as.character(MyData$components_medium.f                                   ))
MyData$components_strong.f                       <-as.numeric(as.character(MyData$components_strong.f                                   ))


MyData$Resp<-rep(1,length(MyData$total_drinks_4weeks.b))

MyData$Resp[is.na(MyData$total_drinks_4weeks.f)]<-0


```
#-------------------------------------------------------#
#---Create a non-response weight------------------------#
#-------------------------------------------------------#


```{r}

MyData$DEMO4<-as.factor(MyData$DEMO4) #race

MyData$DEMO6 #education

MyData$DEMO7 #children

MyData$DEMO8<-as.factor(MyData$DEMO8) #marital status

MyData$DEMO9 #income

save(MyData,file="MyData.RData",compress=T)

library("twang")

NR.ps <-ps(Resp ~ Assignment+SRHT_SRO+RTCSU.sum.all.b+total_drinks_4weeks.b+daysbinge.b+daysmj.b+
             Gender+Age+DEMO3+DEMO4+DEMO6+DEMO7+DEMO8+DEMO9,
           data=MyData,
           n.trees=10000,
           interaction.depth=3,
           shrinkage=0.001,
           perm.test.iters=0,
           stop.method=c("ks.max"),
           estimand = "ATE",
           verbose=TRUE)


MyData$wgt <- get.weights(NR.ps, stop.method="ks.max")



# get the balance tables
bal.table(NR.ps)

#summary(NR.ps$gbm.obj, n.trees=NR.ps$desc$ks.stat.max$n.trees)
summary(NR.ps)

#----This command saves the object containing the propensity score model above
save(NR.ps,file="NR.ps.RData",compress=T)

cbind(MyData$wgt,MyData$Resp)

#---setting to 0 the weights for the non-respondents
MyData$wgt[MyData$Resp==0]<-0

save(MyData,file="MyData.RData",compress=T)

write.csv(MyData,file="MyData.csv")

save(MyData,file="MyData.RData",compress=T)



#---------------------------------------------------------------
#---Create Respondents only file
#---------------------------------------------------------------
MyDataR<-MyData[MyData$Resp==1,]


```

```{r}


#---------------------------------------------------------------
#---Create Variables for effect size calculations
#---------------------------------------------------------------


#calculate .Diff variables for effect size of changes
MyDataR$prop.drink.with.Diff<-MyDataR$prop.drink.with.f- MyDataR$prop.drink.with.b
MyDataR$prop.drink.with.recent.Diff<-MyDataR$prop.drink.with.recent.f- MyDataR$prop.drink.with.recent.b
MyDataR$prop.drugs.with.Diff<-MyDataR$prop.drugs.with.f- MyDataR$prop.drugs.with.b
MyDataR$prop.drugs.with.recent.Diff<-MyDataR$prop.drugs.with.recent.f- MyDataR$prop.drugs.with.recent.b
MyDataR$prop.aod.more.with.Diff<-MyDataR$prop.aod.more.with.f- MyDataR$prop.aod.more.with.b
MyDataR$prop.aod.more.with.recent.Diff<-MyDataR$prop.aod.more.with.recent.f- MyDataR$prop.aod.more.with.recent.b
MyDataR$prop.any.risk.Diff<-MyDataR$prop.any.risk.f- MyDataR$prop.any.risk.b
MyDataR$prop.any.risk.recent.Diff<-MyDataR$prop.any.risk.recent.f- MyDataR$prop.any.risk.recent.b
MyDataR$prop.em.support.Diff<-MyDataR$prop.em.support.f- MyDataR$prop.em.support.b
MyDataR$prop.em.support.recent.Diff<-MyDataR$prop.em.support.recent.f- MyDataR$prop.em.support.recent.b
MyDataR$prop.info.support.Diff<-MyDataR$prop.info.support.f- MyDataR$prop.info.support.b
MyDataR$prop.info.support.recent.Diff<-MyDataR$prop.info.support.recent.f- MyDataR$prop.info.support.recent.b
MyDataR$prop.tan.support.Diff<-MyDataR$prop.tan.support.f- MyDataR$prop.tan.support.b
MyDataR$prop.tan.support.recent.Diff<-MyDataR$prop.tan.support.recent.f- MyDataR$prop.tan.support.recent.b
MyDataR$prop.any.support.Diff<-MyDataR$prop.any.support.f- MyDataR$prop.any.support.b
MyDataR$prop.any.support.recent.Diff<-MyDataR$prop.any.support.recent.f- MyDataR$prop.any.support.recent.b
MyDataR$ave.negative.rel.Diff<-MyDataR$ave.negative.rel.f- MyDataR$ave.negative.rel.b
MyDataR$prop.time.spend.more.Diff<-MyDataR$prop.time.spend.more.f- MyDataR$prop.time.spend.more.b
MyDataR$prop.time.spend.more.or.same.Diff<-MyDataR$prop.time.spend.more.or.same.f- MyDataR$prop.time.spend.more.or.same.b
MyDataR$prop.time.spend.less.Diff<-MyDataR$prop.time.spend.less.f- MyDataR$prop.time.spend.less.b
MyDataR$prop.time.spend.same.Diff<-MyDataR$prop.time.spend.same.f- MyDataR$prop.time.spend.same.b
MyDataR$prop.risk.and.support.Diff<-MyDataR$prop.risk.and.support.f- MyDataR$prop.risk.and.support.b
MyDataR$prop.risk.not.support.Diff<-MyDataR$prop.risk.not.support.f- MyDataR$prop.risk.not.support.b
MyDataR$prop.support.not.risk.Diff<-MyDataR$prop.support.not.risk.f- MyDataR$prop.support.not.risk.b
MyDataR$prop.risk.and.support.recent.Diff<-MyDataR$prop.risk.and.support.recent.f- MyDataR$prop.risk.and.support.recent.b
MyDataR$prop.risk.not.support.recent.Diff<-MyDataR$prop.risk.not.support.recent.f- MyDataR$prop.risk.not.support.recent.b
MyDataR$prop.support.not.risk.recent.Diff<-MyDataR$prop.support.not.risk.recent.f- MyDataR$prop.support.not.risk.recent.b
MyDataR$ave.risk.degree_w.Diff<-MyDataR$ave.risk.degree_w.f- MyDataR$ave.risk.degree_w.b
MyDataR$ave.risk.degree_m.Diff<-MyDataR$ave.risk.degree_m.f- MyDataR$ave.risk.degree_m.b
MyDataR$ave.risk.degree_s.Diff<-MyDataR$ave.risk.degree_s.f- MyDataR$ave.risk.degree_s.b
MyDataR$ave.risk.recent.degree_w.Diff<-MyDataR$ave.risk.recent.degree_w.f- MyDataR$ave.risk.recent.degree_w.b
MyDataR$ave.risk.recent.degree_m.Diff<-MyDataR$ave.risk.recent.degree_m.f- MyDataR$ave.risk.recent.degree_m.b
MyDataR$ave.risk.recent.degree_s.Diff<-MyDataR$ave.risk.recent.degree_s.f- MyDataR$ave.risk.recent.degree_s.b
MyDataR$ave.support.degree_w.Diff<-MyDataR$ave.support.degree_w.f- MyDataR$ave.support.degree_w.b
MyDataR$ave.support.degree_m.Diff<-MyDataR$ave.support.degree_m.f- MyDataR$ave.support.degree_m.b
MyDataR$ave.support.degree_s.Diff<-MyDataR$ave.support.degree_s.f- MyDataR$ave.support.degree_s.b
MyDataR$ave.support.recent.degree_w.Diff<-MyDataR$ave.support.recent.degree_w.f- MyDataR$ave.support.recent.degree_w.b
MyDataR$ave.support.recent.degree_m.Diff<-MyDataR$ave.support.recent.degree_m.f- MyDataR$ave.support.recent.degree_m.b
MyDataR$ave.support.recent.degree_s.Diff<-MyDataR$ave.support.recent.degree_s.f- MyDataR$ave.support.recent.degree_s.b
MyDataR$density_weak.Diff<-MyDataR$density_weak.f- MyDataR$density_weak.b
MyDataR$density_medium.Diff<-MyDataR$density_medium.f- MyDataR$density_medium.b
MyDataR$density_strong.Diff<-MyDataR$density_strong.f- MyDataR$density_strong.b
MyDataR$components_weak.Diff<-MyDataR$components_weak.f- MyDataR$components_weak.b
MyDataR$components_medium.Diff<-MyDataR$components_medium.f- MyDataR$components_medium.b
MyDataR$components_strong.Diff<-MyDataR$components_strong.f- MyDataR$components_strong.b


```

Create data set for only SRHT residents
```{r}

MyDataR.SRHT<-MyDataR[MyDataR$SRHT_SRO=="SRHT",]


save(MyDataR,file="MyDataR.RData",compress=T)
write.csv(MyDataR,file="MyDataR.csv")


save(MyDataR.SRHT,file="MyDataR.SRHT.RData",compress=T)
write.csv(MyDataR.SRHT,file="MyDataR.SRHT.csv")



```

##Set up model design and output matrix

```{r}


library("survey")

#full sample
designR <- svydesign(ids=~1,weights=~wgt,data=MyDataR)

#SRHT only
designR.SRHT <- svydesign(ids=~1,weights=~wgt,data=MyDataR.SRHT)


net.churn.stats.all<-matrix( nrow= 45, ncol=14)
colnames(net.churn.stats.all) <- c("varname", "mean.base.con", "sd.base.con", "mean.fu.con", "sd.fu.con", "mean.base.int", "sd.base.int", "mean.fu.int", "sd.fu.int", "est", "p val", "95 CI L", "95 CI H", "eff size")


net.vars <- matrix( nrow= 45, ncol=1)

net.vars[1 ,1] <-"prop.drink.with"
net.vars[2 ,1] <-"prop.drink.with.recent"
net.vars[3 ,1] <-"prop.drugs.with"
net.vars[4 ,1] <-"prop.drugs.with.recent"
net.vars[5 ,1] <-"prop.aod.more.with"
net.vars[6 ,1] <-"prop.aod.more.with.recent"
net.vars[7 ,1] <-"prop.any.risk"
net.vars[8 ,1] <-"prop.any.risk.recent"
net.vars[9 ,1] <-"prop.em.support"
net.vars[10,1] <-"prop.em.support.recent"
net.vars[11,1] <-"prop.info.support"
net.vars[12,1] <-"prop.info.support.recent"
net.vars[13,1] <-"prop.tan.support"
net.vars[14,1] <-"prop.tan.support.recent"
net.vars[15,1] <-"prop.any.support"
net.vars[16,1] <-"prop.any.support.recent"
net.vars[17,1] <-"ave.negative.rel"
net.vars[18,1] <-"prop.time.spend.more"
net.vars[19,1] <-"prop.time.spend.more.or.same"
net.vars[20,1] <-"prop.time.spend.less"
net.vars[21,1] <-"prop.time.spend.same"
net.vars[22,1] <-"prop.risk.and.support"
net.vars[23,1] <-"prop.risk.not.support"
net.vars[24,1] <-"prop.support.not.risk"
net.vars[25,1] <-"prop.risk.and.support.recent"
net.vars[26,1] <-"prop.risk.not.support.recent"
net.vars[27,1] <-"prop.support.not.risk.recent"
net.vars[28,1] <-"ave.risk.degree_w"
net.vars[29,1] <-"ave.risk.degree_m"
net.vars[30,1] <-"ave.risk.degree_s"
net.vars[31,1] <-"ave.risk.recent.degree_w"
net.vars[32,1] <-"ave.risk.recent.degree_m"
net.vars[33,1] <-"ave.risk.recent.degree_s"
net.vars[34,1] <-"ave.support.degree_w"
net.vars[35,1] <-"ave.support.degree_m"
net.vars[36,1] <-"ave.support.degree_s"
net.vars[37,1] <-"ave.support.recent.degree_w"
net.vars[38,1] <-"ave.support.recent.degree_m"
net.vars[39,1] <-"ave.support.recent.degree_s"
net.vars[40,1] <-"density_weak"
net.vars[41,1] <-"density_medium"
net.vars[42,1] <-"density_strong"
net.vars[43,1] <-"components_weak"
net.vars[44,1] <-"components_medium"
net.vars[45,1] <-"components_strong"



vars.order <- matrix( nrow= 45, ncol=1)


vars.order[1 ,1] <-  1
vars.order[2 ,1] <-  2
vars.order[3 ,1] <-  3
vars.order[4 ,1] <-  4
vars.order[5 ,1] <-  5
vars.order[6 ,1] <-  6
vars.order[7 ,1] <-  7
vars.order[8 ,1] <-  8
vars.order[9 ,1] <-  9
vars.order[10,1] <- 10
vars.order[11,1] <- 11
vars.order[12,1] <- 12
vars.order[13,1] <- 13
vars.order[14,1] <- 14
vars.order[15,1] <- 15
vars.order[16,1] <- 16
vars.order[22,1] <- 17
vars.order[25,1] <- 18
vars.order[23,1] <- 19
vars.order[26,1] <- 20
vars.order[24,1] <- 21
vars.order[27,1] <- 22
vars.order[28,1] <- 23
vars.order[31,1] <- 24
vars.order[34,1] <- 25
vars.order[37,1] <- 26
vars.order[17,1] <- 99
vars.order[29,1] <- 99
vars.order[30,1] <- 99
vars.order[32,1] <- 99
vars.order[33,1] <- 99
vars.order[35,1] <- 99
vars.order[36,1] <- 99
vars.order[38,1] <- 99
vars.order[39,1] <- 99
vars.order[44,1] <- 99
vars.order[45,1] <- 99
vars.order[43,1] <- 99
vars.order[41,1] <- 99
vars.order[42,1] <- 99
vars.order[40,1] <- 99
vars.order[20,1] <- 99
vars.order[18,1] <- 99
vars.order[19,1] <- 99
vars.order[21,1] <- 99



```


#All Paper Models

```{r}
#---Full sample
#---prop.drink.with
#---gaussian
mod1<-svyglm(prop.drink.with.f~prop.drink.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 1
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drink.with.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.drink.with.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drink.with.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.drink.with.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---Full sample
#---prop.drink.with.recent
#---gaussian
mod1<-svyglm(prop.drink.with.recent.f~prop.drink.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 2
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drink.with.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.drink.with.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drink.with.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.drink.with.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---Full sample
#---prop.drugs.with
#---gaussian
mod1<-svyglm(prop.drugs.with.f~prop.drugs.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 3
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drugs.with.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.drugs.with.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drugs.with.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.drugs.with.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---Full sample
#---prop.drugs.with.recent
#---gaussian
mod1<-svyglm(prop.drugs.with.recent.f~prop.drugs.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 4
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drugs.with.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.drugs.with.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drugs.with.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.drugs.with.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int



#---Full sample
#---prop.aod.more.with
#---gaussian
mod1<-svyglm(prop.aod.more.with.f~prop.aod.more.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 5
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.aod.more.with.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.aod.more.with.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.aod.more.with.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.aod.more.with.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.aod.more.with.recent
#---gaussian
mod1<-svyglm(prop.aod.more.with.recent.f~prop.aod.more.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 6
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.aod.more.with.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.aod.more.with.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.aod.more.with.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.aod.more.with.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int








#---Full sample
#---prop.any.risk
#---gaussian
mod1<-svyglm(prop.any.risk.f~prop.any.risk.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 7
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.risk.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.any.risk.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.risk.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.any.risk.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---prop.any.risk.recent
#---gaussian
mod1<-svyglm(prop.any.risk.recent.f~prop.any.risk.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 8
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.risk.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.any.risk.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.risk.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.any.risk.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int









#---Full sample
#---prop.em.support
#---gaussian
mod1<-svyglm(prop.em.support.f~prop.em.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 9
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.em.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.em.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.em.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.em.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.em.support.recent
#---gaussian
mod1<-svyglm(prop.em.support.recent.f~prop.em.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 10
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.em.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.em.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.em.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.em.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---prop.info.support
#---gaussian
mod1<-svyglm(prop.info.support.f~prop.info.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 11
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.info.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.info.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.info.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.info.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.info.support.recent
#---gaussian
mod1<-svyglm(prop.info.support.recent.f~prop.info.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 12
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.info.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.info.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.info.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.info.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---Full sample
#---prop.tan.support
#---gaussian
mod1<-svyglm(prop.tan.support.f~prop.tan.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 13
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.tan.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.tan.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.tan.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.tan.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.tan.support.recent
#---gaussian
mod1<-svyglm(prop.tan.support.recent.f~prop.tan.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 14
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.tan.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.tan.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.tan.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.tan.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int









#---Full sample
#---prop.any.support
#---gaussian
mod1<-svyglm(prop.any.support.f~prop.any.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

summary(mod1)
beta <- coef(mod1)
confint.default(mod1)


v <- 15
summ <- summary(mod1)
beta <- coef(mod1)
beta
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)
ci

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.any.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.any.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.any.support.recent
#---gaussian
mod1<-svyglm(prop.any.support.recent.f~prop.any.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 16
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)


summary(mod1)
beta <- coef(mod1)
confint.default(mod1)



net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.any.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.any.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---ave.negative.rel
#---gaussian
mod1<-svyglm(ave.negative.rel.f~ave.negative.rel.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 17
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.negative.rel.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.negative.rel.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.negative.rel.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.negative.rel.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.time.spend.more
#---gaussian
mod1<-svyglm(prop.time.spend.more.f~prop.time.spend.more.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 18
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.more.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.time.spend.more.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.more.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.time.spend.more.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.time.spend.more.or.same
#---gaussian
mod1<-svyglm(prop.time.spend.more.or.same.f~prop.time.spend.more.or.same.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 19
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.more.or.same.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.time.spend.more.or.same.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.more.or.same.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.time.spend.more.or.same.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---prop.time.spend.less
#---gaussian
mod1<-svyglm(prop.time.spend.less.f~prop.time.spend.less.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 20
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.less.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.time.spend.less.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.less.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.time.spend.less.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int








#---Full sample
#---prop.time.spend.same
#---gaussian
mod1<-svyglm(prop.time.spend.same.f~prop.time.spend.same.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 21
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.same.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.time.spend.same.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.same.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.time.spend.same.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---prop.risk.and.support
#---gaussian
mod1<-svyglm(prop.risk.and.support.f~prop.risk.and.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 22
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.and.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.risk.and.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.and.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.risk.and.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.risk.not.support
#---gaussian
mod1<-svyglm(prop.risk.not.support.f~prop.risk.not.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 23
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.not.support.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.risk.not.support.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.not.support.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.risk.not.support.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---Full sample
#---prop.support.not.risk
#---gaussian
mod1<-svyglm(prop.support.not.risk.f~prop.support.not.risk.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 24
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.support.not.risk.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.support.not.risk.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.support.not.risk.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.support.not.risk.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---Full sample
#---prop.risk.and.support.recent
#---gaussian
mod1<-svyglm(prop.risk.and.support.recent.f~prop.risk.and.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 25
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.and.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.risk.and.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.and.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.risk.and.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---prop.risk.not.support.recent
#---gaussian
mod1<-svyglm(prop.risk.not.support.recent.f~prop.risk.not.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 26
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.not.support.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.risk.not.support.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.not.support.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.risk.not.support.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---Full sample
#---prop.support.not.risk.recent
#---gaussian
mod1<-svyglm(prop.support.not.risk.recent.f~prop.support.not.risk.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 27
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.support.not.risk.recent.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~prop.support.not.risk.recent.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.support.not.risk.recent.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~prop.support.not.risk.recent.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---Full sample
#---ave.risk.degree_w
#---gaussian
mod1<-svyglm(ave.risk.degree_w.f~ave.risk.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 28
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_w.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_w.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_w.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_w.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---Full sample
#---ave.risk.degree_m
#---gaussian
mod1<-svyglm(ave.risk.degree_m.f~ave.risk.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 29
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_m.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_m.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_m.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_m.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---Full sample
#---ave.risk.degree_s
#---gaussian
mod1<-svyglm(ave.risk.degree_s.f~ave.risk.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 30
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_s.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_s.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_s.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_s.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int













#---Full sample
#---ave.risk.recent.degree_w
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_w.f~ave.risk.recent.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 31
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_w.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_w.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_w.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_w.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---Full sample
#---ave.risk.recent.degree_m
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_m.f~ave.risk.recent.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 32
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_m.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_m.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_m.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_m.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---Full sample
#---ave.risk.recent.degree_s
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_s.f~ave.risk.recent.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 33
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_s.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_s.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_s.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_s.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int














#---Full sample
#---ave.support.degree_w
#---gaussian
mod1<-svyglm(ave.support.degree_w.f~ave.support.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 34
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_w.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.degree_w.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_w.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.degree_w.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---Full sample
#---ave.support.degree_m
#---gaussian
mod1<-svyglm(ave.support.degree_m.f~ave.support.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 35
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_m.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.degree_m.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_m.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.degree_m.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---Full sample
#---ave.support.degree_s
#---gaussian
mod1<-svyglm(ave.support.degree_s.f~ave.support.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 36
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_s.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.degree_s.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_s.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.degree_s.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---Full sample
#---ave.support.recent.degree_w
#---gaussian
mod1<-svyglm(ave.support.recent.degree_w.f~ave.support.recent.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 37
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_w.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_w.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_w.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_w.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---Full sample
#---ave.support.recent.degree_m
#---gaussian
mod1<-svyglm(ave.support.recent.degree_m.f~ave.support.recent.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 38
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_m.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_m.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_m.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_m.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---Full sample
#---ave.support.recent.degree_s
#---gaussian
mod1<-svyglm(ave.support.recent.degree_s.f~ave.support.recent.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 39
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_s.b,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_s.b,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_s.f,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_s.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int



#---Full sample
#---density_weak
#---gaussian
mod1<-svyglm(density_weak.f~density_weak.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 40
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_weak,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~density_weak,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_weak,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~density_weak,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---Full sample
#---density_medium
#---gaussian
mod1<-svyglm(density_medium.f~density_medium.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 41
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_medium,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~density_medium,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_medium,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~density_medium,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---density_strong
#---gaussian
mod1<-svyglm(density_strong.f~density_strong.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 42
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_strong,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~density_strong,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_strong,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~density_strong,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---components_weak
#---gaussian
mod1<-svyglm(components_weak.f~components_weak.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 43
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_weak,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~components_weak,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_weak,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~components_weak,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---Full sample
#---components_medium
#---gaussian
mod1<-svyglm(components_medium.f~components_medium.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 44
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_medium,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~components_medium,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_medium,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~components_medium,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---components_strong
#---gaussian
mod1<-svyglm(components_strong.f~components_strong.b+Assignment,family=gaussian(link = "identity"),
             design=designR)

v <- 45
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.all[v,1]  <- net.vars[v,1]
net.churn.stats.all[v,10] <- round(beta[3], 2)
net.churn.stats.all[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.all[v,12] <- round(ci[3,1], 2)
net.churn.stats.all[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_strong,~Assignment,designR, svymean)
s.b <- sqrt(svyby(~components_strong,~Assignment,designR, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_strong,~Assignment,designR, svymean)
s.f <- sqrt(svyby(~components_strong,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR)
m.f.con <- svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.stats.all[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.all[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.all[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.all[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.all[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.all[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.all[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.all[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---Full sample
#---Add In Effect Sizes

m<-svyby(~prop.drink.with.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drink.with.Diff,designR,na.rm=T))
net.churn.stats.all[1,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drink.with.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drink.with.recent.Diff,designR,na.rm=T))
net.churn.stats.all[2,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drugs.with.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drugs.with.Diff,designR,na.rm=T))
net.churn.stats.all[3,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drugs.with.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drugs.with.recent.Diff,designR,na.rm=T))
net.churn.stats.all[4,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.aod.more.with.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.aod.more.with.Diff,designR,na.rm=T))
net.churn.stats.all[5,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.aod.more.with.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.aod.more.with.recent.Diff,designR,na.rm=T))
net.churn.stats.all[6,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.risk.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.risk.Diff,designR,na.rm=T))
net.churn.stats.all[7,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.risk.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.risk.recent.Diff,designR,na.rm=T))
net.churn.stats.all[8,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.em.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.em.support.Diff,designR,na.rm=T))
net.churn.stats.all[9,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.em.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.em.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[10,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.info.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.info.support.Diff,designR,na.rm=T))
net.churn.stats.all[11,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.info.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.info.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[12,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.tan.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.tan.support.Diff,designR,na.rm=T))
net.churn.stats.all[13,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.tan.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.tan.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[14,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.support.Diff,designR,na.rm=T))
net.churn.stats.all[15,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[16,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.negative.rel.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.negative.rel.Diff,designR,na.rm=T))
net.churn.stats.all[17,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.more.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.more.Diff,designR,na.rm=T))
net.churn.stats.all[18,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.more.or.same.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.more.or.same.Diff,designR,na.rm=T))
net.churn.stats.all[19,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.less.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.less.Diff,designR,na.rm=T))
net.churn.stats.all[20,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.same.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.same.Diff,designR,na.rm=T))
net.churn.stats.all[21,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.and.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.and.support.Diff,designR,na.rm=T))
net.churn.stats.all[22,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.not.support.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.not.support.Diff,designR,na.rm=T))
net.churn.stats.all[23,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.support.not.risk.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.support.not.risk.Diff,designR,na.rm=T))
net.churn.stats.all[24,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.and.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.and.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[25,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.not.support.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.not.support.recent.Diff,designR,na.rm=T))
net.churn.stats.all[26,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.support.not.risk.recent.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.support.not.risk.recent.Diff,designR,na.rm=T))
net.churn.stats.all[27,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_w.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_w.Diff,designR,na.rm=T))
net.churn.stats.all[28,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_m.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_m.Diff,designR,na.rm=T))
net.churn.stats.all[29,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_s.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_s.Diff,designR,na.rm=T))
net.churn.stats.all[30,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_w.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_w.Diff,designR,na.rm=T))
net.churn.stats.all[31,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_m.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_m.Diff,designR,na.rm=T))
net.churn.stats.all[32,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_s.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_s.Diff,designR,na.rm=T))
net.churn.stats.all[33,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_w.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_w.Diff,designR,na.rm=T))
net.churn.stats.all[34,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_m.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_m.Diff,designR,na.rm=T))
net.churn.stats.all[35,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_s.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_s.Diff,designR,na.rm=T))
net.churn.stats.all[36,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_w.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_w.Diff,designR,na.rm=T))
net.churn.stats.all[37,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_m.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_m.Diff,designR,na.rm=T))
net.churn.stats.all[38,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_s.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_s.Diff,designR,na.rm=T))
net.churn.stats.all[39,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_weak.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~density_weak.Diff,designR,na.rm=T))
net.churn.stats.all[40,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_medium.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~density_medium.Diff,designR,na.rm=T))
net.churn.stats.all[41,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_strong.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~density_strong.Diff,designR,na.rm=T))
net.churn.stats.all[42,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_weak.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~components_weak.Diff,designR,na.rm=T))
net.churn.stats.all[43,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_medium.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~components_medium.Diff,designR,na.rm=T))
net.churn.stats.all[44,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_strong.Diff,~Assignment,designR,svymean,na.rm=T)
v<-sqrt(svyvar(~components_strong.Diff,designR,na.rm=T))
net.churn.stats.all[45,14] <-round((m[2,2]-m[1,2])/v, 2)


net.churn.stats.all <- cbind(net.churn.stats.all, vars.order)


write.csv( net.churn.stats.all, file='net.churn.stats.all.csv')


net.churn.stats.srht<-matrix( nrow= 45, ncol=14)
colnames(net.churn.stats.srht) <- c("varname", "mean.base.con", "sd.base.con", "mean.fu.con", "sd.fu.con", "mean.base.int", "sd.base.int", "mean.fu.int", "sd.fu.int", "est", "p val", "95 CI L", "95 CI H", "eff size")





#---SRHT only
#---prop.drink.with
#---gaussian
mod1<-svyglm(prop.drink.with.f~prop.drink.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 1
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drink.with.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.drink.with.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drink.with.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.drink.with.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---prop.drink.with.recent
#---gaussian
mod1<-svyglm(prop.drink.with.recent.f~prop.drink.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 2
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drink.with.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.drink.with.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drink.with.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.drink.with.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---prop.drugs.with
#---gaussian
mod1<-svyglm(prop.drugs.with.f~prop.drugs.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 3
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drugs.with.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.drugs.with.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drugs.with.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.drugs.with.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---prop.drugs.with.recent
#---gaussian
mod1<-svyglm(prop.drugs.with.recent.f~prop.drugs.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 4
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.drugs.with.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.drugs.with.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.drugs.with.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.drugs.with.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int



#---SRHT only
#---prop.aod.more.with
#---gaussian
mod1<-svyglm(prop.aod.more.with.f~prop.aod.more.with.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 5
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.aod.more.with.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.aod.more.with.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.aod.more.with.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.aod.more.with.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.aod.more.with.recent
#---gaussian
mod1<-svyglm(prop.aod.more.with.recent.f~prop.aod.more.with.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 6
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.aod.more.with.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.aod.more.with.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.aod.more.with.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.aod.more.with.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int








#---SRHT only
#---prop.any.risk
#---gaussian
mod1<-svyglm(prop.any.risk.f~prop.any.risk.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 7
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.risk.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.any.risk.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.risk.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.any.risk.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---prop.any.risk.recent
#---gaussian
mod1<-svyglm(prop.any.risk.recent.f~prop.any.risk.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 8
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.risk.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.any.risk.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.risk.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.any.risk.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int









#---SRHT only
#---prop.em.support
#---gaussian
mod1<-svyglm(prop.em.support.f~prop.em.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 9
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.em.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.em.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.em.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.em.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.em.support.recent
#---gaussian
mod1<-svyglm(prop.em.support.recent.f~prop.em.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 10
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.em.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.em.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.em.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.em.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---prop.info.support
#---gaussian
mod1<-svyglm(prop.info.support.f~prop.info.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 11
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.info.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.info.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.info.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.info.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.info.support.recent
#---gaussian
mod1<-svyglm(prop.info.support.recent.f~prop.info.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 12
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.info.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.info.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.info.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.info.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---SRHT only
#---prop.tan.support
#---gaussian
mod1<-svyglm(prop.tan.support.f~prop.tan.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 13
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.tan.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.tan.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.tan.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.tan.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.tan.support.recent
#---gaussian
mod1<-svyglm(prop.tan.support.recent.f~prop.tan.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 14
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.tan.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.tan.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.tan.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.tan.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int









#---SRHT only
#---prop.any.support
#---gaussian
mod1<-svyglm(prop.any.support.f~prop.any.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 15
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.any.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.any.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.any.support.recent
#---gaussian
mod1<-svyglm(prop.any.support.recent.f~prop.any.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 16
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.any.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.any.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.any.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.any.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---ave.negative.rel
#---gaussian
mod1<-svyglm(ave.negative.rel.f~ave.negative.rel.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 17
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.negative.rel.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.negative.rel.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.negative.rel.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.negative.rel.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.time.spend.more
#---gaussian
mod1<-svyglm(prop.time.spend.more.f~prop.time.spend.more.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 18
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.more.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.time.spend.more.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.more.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.time.spend.more.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.time.spend.more.or.same
#---gaussian
mod1<-svyglm(prop.time.spend.more.or.same.f~prop.time.spend.more.or.same.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 19
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.more.or.same.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.time.spend.more.or.same.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.more.or.same.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.time.spend.more.or.same.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---prop.time.spend.less
#---gaussian
mod1<-svyglm(prop.time.spend.less.f~prop.time.spend.less.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 20
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.less.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.time.spend.less.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.less.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.time.spend.less.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int








#---SRHT only
#---prop.time.spend.same
#---gaussian
mod1<-svyglm(prop.time.spend.same.f~prop.time.spend.same.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 21
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.time.spend.same.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.time.spend.same.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.time.spend.same.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.time.spend.same.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---prop.risk.and.support
#---gaussian
mod1<-svyglm(prop.risk.and.support.f~prop.risk.and.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 22
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.and.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.risk.and.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.and.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.risk.and.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.risk.not.support
#---gaussian
mod1<-svyglm(prop.risk.not.support.f~prop.risk.not.support.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 23
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.not.support.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.risk.not.support.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.not.support.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.risk.not.support.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---SRHT only
#---prop.support.not.risk
#---gaussian
mod1<-svyglm(prop.support.not.risk.f~prop.support.not.risk.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 24
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.support.not.risk.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.support.not.risk.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.support.not.risk.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.support.not.risk.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---prop.risk.and.support.recent
#---gaussian
mod1<-svyglm(prop.risk.and.support.recent.f~prop.risk.and.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 25
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.and.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.risk.and.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.and.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.risk.and.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---prop.risk.not.support.recent
#---gaussian
mod1<-svyglm(prop.risk.not.support.recent.f~prop.risk.not.support.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 26
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.risk.not.support.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.risk.not.support.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.risk.not.support.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.risk.not.support.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---SRHT only
#---prop.support.not.risk.recent
#---gaussian
mod1<-svyglm(prop.support.not.risk.recent.f~prop.support.not.risk.recent.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 27
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~prop.support.not.risk.recent.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~prop.support.not.risk.recent.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~prop.support.not.risk.recent.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~prop.support.not.risk.recent.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int












#---SRHT only
#---ave.risk.degree_w
#---gaussian
mod1<-svyglm(ave.risk.degree_w.f~ave.risk.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 28
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_w.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_w.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_w.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_w.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---SRHT only
#---ave.risk.degree_m
#---gaussian
mod1<-svyglm(ave.risk.degree_m.f~ave.risk.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 29
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_m.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_m.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_m.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_m.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---SRHT only
#---ave.risk.degree_s
#---gaussian
mod1<-svyglm(ave.risk.degree_s.f~ave.risk.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 30
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.degree_s.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.degree_s.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.degree_s.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.degree_s.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int













#---SRHT only
#---ave.risk.recent.degree_w
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_w.f~ave.risk.recent.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 31
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_w.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_w.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_w.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_w.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---SRHT only
#---ave.risk.recent.degree_m
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_m.f~ave.risk.recent.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 32
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_m.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_m.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_m.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_m.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---SRHT only
#---ave.risk.recent.degree_s
#---gaussian
mod1<-svyglm(ave.risk.recent.degree_s.f~ave.risk.recent.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 33
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.risk.recent.degree_s.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.risk.recent.degree_s.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.risk.recent.degree_s.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.risk.recent.degree_s.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int














#---SRHT only
#---ave.support.degree_w
#---gaussian
mod1<-svyglm(ave.support.degree_w.f~ave.support.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 34
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_w.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.degree_w.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_w.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.degree_w.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---SRHT only
#---ave.support.degree_m
#---gaussian
mod1<-svyglm(ave.support.degree_m.f~ave.support.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 35
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_m.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.degree_m.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_m.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.degree_m.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---SRHT only
#---ave.support.degree_s
#---gaussian
mod1<-svyglm(ave.support.degree_s.f~ave.support.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 36
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.degree_s.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.degree_s.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.degree_s.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.degree_s.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int







#---SRHT only
#---ave.support.recent.degree_w
#---gaussian
mod1<-svyglm(ave.support.recent.degree_w.f~ave.support.recent.degree_w.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 37
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_w.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_w.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_w.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_w.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int











#---SRHT only
#---ave.support.recent.degree_m
#---gaussian
mod1<-svyglm(ave.support.recent.degree_m.f~ave.support.recent.degree_m.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 38
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_m.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_m.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_m.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_m.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int










#---SRHT only
#---ave.support.recent.degree_s
#---gaussian
mod1<-svyglm(ave.support.recent.degree_s.f~ave.support.recent.degree_s.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 39
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~ave.support.recent.degree_s.b,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~ave.support.recent.degree_s.b,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~ave.support.recent.degree_s.f,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~ave.support.recent.degree_s.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int




#---SRHT only
#---density_weak
#---gaussian
mod1<-svyglm(density_weak.f~density_weak.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 40
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_weak,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~density_weak,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_weak,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~density_weak,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---density_medium
#---gaussian
mod1<-svyglm(density_medium.f~density_medium.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 41
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_medium,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~density_medium,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_medium,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~density_medium,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---density_strong
#---gaussian
mod1<-svyglm(density_strong.f~density_strong.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 42
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~density_strong,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~density_strong,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~density_strong,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~density_strong,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---components_weak
#---gaussian
mod1<-svyglm(components_weak.f~components_weak.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 43
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_weak,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~components_weak,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_weak,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~components_weak,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---components_medium
#---gaussian
mod1<-svyglm(components_medium.f~components_medium.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 44
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_medium,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~components_medium,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_medium,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~components_medium,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int






#---SRHT only
#---components_strong
#---gaussian
mod1<-svyglm(components_strong.f~components_strong.b+Assignment,family=gaussian(link = "identity"),
             design=designR.SRHT)

v <- 45
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.stats.srht[v,1]  <- net.vars[v,1]
net.churn.stats.srht[v,10] <- round(beta[3], 2)
net.churn.stats.srht[v,11] <- round(summ$coefficients[3,4], 3)
net.churn.stats.srht[v,12] <- round(ci[3,1], 2)
net.churn.stats.srht[v,13] <- round(ci[3,2], 2)

#---Baseline
m.b <- svyby(~components_strong,~Assignment,designR.SRHT, svymean)
s.b <- sqrt(svyby(~components_strong,~Assignment,designR.SRHT, svyvar))

#---Follow-up
m.f.1 <- svyby(~components_strong,~Assignment,designR.SRHT, svymean)
s.f <- sqrt(svyby(~components_strong,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

m.f.int <- svymean(~s11,designR.SRHT)
m.f.con <- svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.stats.srht[v,2] <- round(m.b[1,2], 2) #mean.base.con
net.churn.stats.srht[v,3] <- round(s.b[1,2], 2) #sd.base.con
net.churn.stats.srht[v,4] <- round(m.f.con, 2) #mean.fu.con
net.churn.stats.srht[v,5] <- round(s.f[1,2], 2) #sd.fu.con

net.churn.stats.srht[v,6] <- round(m.b[2,2], 2) #mean.base.int
net.churn.stats.srht[v,7] <- round(s.b[2,2], 2) #sd.base.int
net.churn.stats.srht[v,8] <- round(m.f.int, 2) #mean.fu.int
net.churn.stats.srht[v,9] <- round(s.f[2,2], 2) #sd.fu.int





#---SRHT only
#---Add In Effect Sizes

m<-svyby(~prop.drink.with.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drink.with.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[1,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drink.with.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drink.with.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[2,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drugs.with.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drugs.with.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[3,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.drugs.with.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.drugs.with.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[4,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.aod.more.with.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.aod.more.with.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[5,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.aod.more.with.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.aod.more.with.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[6,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.risk.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.risk.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[7,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.risk.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.risk.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[8,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.em.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.em.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[9,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.em.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.em.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[10,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.info.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.info.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[11,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.info.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.info.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[12,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.tan.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.tan.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[13,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.tan.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.tan.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[14,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[15,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.any.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.any.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[16,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.negative.rel.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.negative.rel.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[17,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.more.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.more.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[18,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.more.or.same.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.more.or.same.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[19,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.less.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.less.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[20,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.time.spend.same.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.time.spend.same.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[21,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.and.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.and.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[22,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.not.support.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.not.support.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[23,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.support.not.risk.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.support.not.risk.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[24,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.and.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.and.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[25,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.risk.not.support.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.risk.not.support.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[26,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~prop.support.not.risk.recent.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~prop.support.not.risk.recent.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[27,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_w.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_w.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[28,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_m.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_m.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[29,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.degree_s.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.degree_s.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[30,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_w.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_w.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[31,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_m.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_m.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[32,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.risk.recent.degree_s.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.risk.recent.degree_s.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[33,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_w.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_w.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[34,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_m.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_m.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[35,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.degree_s.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.degree_s.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[36,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_w.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_w.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[37,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_m.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_m.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[38,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~ave.support.recent.degree_s.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~ave.support.recent.degree_s.Diff,designR.SRHT,na.rm=T))
net.churn.stats.srht[39,14] <-round((m[2,2]-m[1,2])/v, 2)


m<-svyby(~density_weak.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~density_weak.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[40,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_medium.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~density_medium.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[41,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_strong.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~density_strong.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[42,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_weak.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~components_weak.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[43,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_medium.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~components_medium.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[44,14] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_strong.Diff,~Assignment,designR.SRHT,svymean,na.rm=T)
v<-sqrt(svyvar(~components_strong.Diff,designR.SRHT,svymean=T))
net.churn.stats.srht[45,14] <-round((m[2,2]-m[1,2])/v, 2)


net.churn.stats.srht <- cbind(net.churn.stats.srht, vars.order)


write.csv( net.churn.stats.srht, file='net.churn.stats.srht.csv')


#HTMLStop()


net.churn.matched.stats.all<-matrix( nrow= 82, ncol=10)
colnames(net.churn.matched.stats.all) <- c("varname", "mean.con", "sd.con", "mean.int", "sd.int", "est", "p val", "95 CI L", "95 CI H", "eff size")


net.matched.vars <- matrix( nrow= 82, ncol=1)

net.matched.vars[1 ,1] <-"dropped.alter.tot"
net.matched.vars[2 ,1] <-"new.alter.tot"
net.matched.vars[3 ,1] <-"retained.alter.tot"
net.matched.vars[4 ,1] <-"stop.drink.tot"
net.matched.vars[5 ,1] <-"stop.drug.tot"
net.matched.vars[6 ,1] <-"stop.aod.more.tot"
net.matched.vars[7 ,1] <-"stop.any.risk.tot"
net.matched.vars[8 ,1] <-"start.drink.tot"
net.matched.vars[9 ,1] <-"start.drug.tot"
net.matched.vars[10,1] <-"start.aod.more.tot"
net.matched.vars[11,1] <-"start.any.risk.tot"
net.matched.vars[12,1] <-"maintain.drink.tot"
net.matched.vars[13,1] <-"maintain.drug.tot"
net.matched.vars[14,1] <-"maintain.aod.more.tot"
net.matched.vars[15,1] <-"maintain.any.risk.tot"
net.matched.vars[16,1] <-"former.drink.tot"
net.matched.vars[17,1] <-"former.drug.tot"
net.matched.vars[18,1] <-"former.aod.more.tot"
net.matched.vars[19,1] <-"former.any.risk.tot"
net.matched.vars[20,1] <-"new.drink.tot"
net.matched.vars[21,1] <-"new.drug.tot"
net.matched.vars[22,1] <-"new.aod.more.tot"
net.matched.vars[23,1] <-"new.any.risk.tot"
net.matched.vars[24,1] <-"stop.em.support.tot"
net.matched.vars[25,1] <-"stop.info.support.tot"
net.matched.vars[26,1] <-"stop.tan.support.tot"
net.matched.vars[27,1] <-"stop.any.support.tot"
net.matched.vars[28,1] <-"start.em.support.tot"
net.matched.vars[29,1] <-"start.info.support.tot"
net.matched.vars[30,1] <-"start.tan.support.tot"
net.matched.vars[31,1] <-"start.any.support.tot"
net.matched.vars[32,1] <-"maintain.em.support.tot"
net.matched.vars[33,1] <-"maintain.info.support.tot"
net.matched.vars[34,1] <-"maintain.tan.support.tot"
net.matched.vars[35,1] <-"maintain.any.support.tot"
net.matched.vars[36,1] <-"former.em.support.tot"
net.matched.vars[37,1] <-"former.info.support.tot"
net.matched.vars[38,1] <-"former.tan.support.tot"
net.matched.vars[39,1] <-"former.any.support.tot"
net.matched.vars[40,1] <-"new.em.support.tot"
net.matched.vars[41,1] <-"new.info.support.tot"
net.matched.vars[42,1] <-"new.tan.support.tot"
net.matched.vars[43,1] <-"new.any.support.tot"
net.matched.vars[44,1] <-"stop.risk.and.support.tot"
net.matched.vars[45,1] <-"stop.risk.not.support.tot"
net.matched.vars[46,1] <-"stop.support.not.risk.tot"
net.matched.vars[47,1] <-"stop.risk.and.support.recent.tot"
net.matched.vars[48,1] <-"stop.risk.not.support.recent.tot"
net.matched.vars[49,1] <-"stop.support.not.risk.recent.tot"
net.matched.vars[50,1] <-"start.risk.and.support.tot"
net.matched.vars[51,1] <-"start.risk.not.support.tot"
net.matched.vars[52,1] <-"start.support.not.risk.tot"
net.matched.vars[53,1] <-"start.risk.and.support.recent.tot"
net.matched.vars[54,1] <-"start.risk.not.support.recent.tot"
net.matched.vars[55,1] <-"start.support.not.risk.recent.tot"
net.matched.vars[56,1] <-"maintain.risk.and.support.tot"
net.matched.vars[57,1] <-"maintain.risk.not.support.tot"
net.matched.vars[58,1] <-"maintain.support.not.risk.tot"
net.matched.vars[59,1] <-"maintain.risk.and.support.recent.tot"
net.matched.vars[60,1] <-"maintain.risk.not.support.recent.tot"
net.matched.vars[61,1] <-"maintain.support.not.risk.recent.tot"
net.matched.vars[62,1] <-"former.risk.and.support.tot"
net.matched.vars[63,1] <-"former.risk.not.support.tot"
net.matched.vars[64,1] <-"former.support.not.risk.tot"
net.matched.vars[65,1] <-"former.risk.and.support.recent.tot"
net.matched.vars[66,1] <-"former.risk.not.support.recent.tot"
net.matched.vars[67,1] <-"former.support.not.risk.recent.tot"
net.matched.vars[68,1] <-"new.risk.and.support.tot"
net.matched.vars[69,1] <-"new.risk.not.support.tot"
net.matched.vars[70,1] <-"new.support.not.risk.tot"
net.matched.vars[71,1] <-"new.risk.and.support.recent.tot"
net.matched.vars[72,1] <-"new.risk.not.support.recent.tot"
net.matched.vars[73,1] <-"new.support.not.risk.recent.tot"
net.matched.vars[74,1] <-"alters"
net.matched.vars[75,1] <-"alters.f"
net.matched.vars[76,1] <-"alters.b"
net.matched.vars[77,1] <-"density_weak"
net.matched.vars[78,1] <-"density_medium"
net.matched.vars[79,1] <-"density_strong"
net.matched.vars[80,1] <-"components_weak"
net.matched.vars[81,1] <-"components_medium"
net.matched.vars[82,1] <-"components_strong"


#HTMLStart(outdir="C:/Users/davidk/Documents/Current Projects/R34 Skid Row/EgoWeb Data/Analysis/R/Outputs", file="svyglm network 2 output",
#          extension="html", echo=FALSE, HTMLframe=TRUE)
#
#HTML.title("R34 Analysis Output", HR = 1)
#
#HTML.title("Network Churn Models", HR = 3)
#
#HTML.title("Matched Alters", HR = 3)


#---Full sample
#--- dropped.alter.tot
# Poisson
mod1<-svyglm(dropped.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 1

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~dropped.alter.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~dropped.alter.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- new.alter.tot
# Poisson
mod1<-svyglm(new.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 2

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.alter.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.alter.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int



#---Full sample
#--- retained.alter.tot
# Poisson
mod1<-svyglm(retained.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 3

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~retained.alter.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~retained.alter.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- stop.drink.tot
# Poisson
mod1<-svyglm(stop.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 4

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.drink.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.drink.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- stop.drug.tot
# Poisson
mod1<-svyglm(stop.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 5

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.drug.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.drug.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- stop.aod.more.tot
# Poisson
mod1<-svyglm(stop.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 6

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.aod.more.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.aod.more.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- stop.any.risk.tot
# Poisson
mod1<-svyglm(stop.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 7

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.any.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.any.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---Full sample
#--- start.drink.tot
# Poisson
mod1<-svyglm(start.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 8

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.drink.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.drink.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- start.drug.tot
# Poisson
mod1<-svyglm(start.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 9

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.drug.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.drug.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- start.aod.more.tot
# Poisson
mod1<-svyglm(start.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 10

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.aod.more.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.aod.more.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- start.any.risk.tot
# Poisson
mod1<-svyglm(start.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 11

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.any.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.any.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- maintain.drink.tot
# Poisson
mod1<-svyglm(maintain.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 12

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.drink.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.drink.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- maintain.drug.tot
# Poisson
mod1<-svyglm(maintain.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 13

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.drug.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.drug.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- maintain.aod.more.tot
# Poisson
mod1<-svyglm(maintain.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 14

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.aod.more.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.aod.more.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- maintain.any.risk.tot
# Poisson
mod1<-svyglm(maintain.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 15

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.any.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.any.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- former.drink.tot
# Poisson
mod1<-svyglm(former.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 16

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.drink.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.drink.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- former.drug.tot
# Poisson
mod1<-svyglm(former.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 17

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.drug.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.drug.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- former.aod.more.tot
# Poisson
mod1<-svyglm(former.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 18

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.aod.more.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.aod.more.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- former.any.risk.tot
# Poisson
mod1<-svyglm(former.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 19

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.any.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.any.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---Full sample
#--- new.drink.tot
# Poisson
mod1<-svyglm(new.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 20

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.drink.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.drink.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- new.drug.tot
# Poisson
mod1<-svyglm(new.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 21

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.drug.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.drug.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- new.aod.more.tot
# Poisson
mod1<-svyglm(new.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 22

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.aod.more.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.aod.more.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- new.any.risk.tot
# Poisson
mod1<-svyglm(new.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 23

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.any.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.any.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int























#---Full sample
#--- stop.em.support.tot
# Poisson
mod1<-svyglm(stop.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 24

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.em.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.em.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- stop.info.support.tot
# Poisson
mod1<-svyglm(stop.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 25

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.info.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.info.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- stop.tan.support.tot
# Poisson
mod1<-svyglm(stop.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 26

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.tan.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.tan.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- stop.any.support.tot
# Poisson
mod1<-svyglm(stop.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 27

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.any.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.any.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---Full sample
#--- start.em.support.tot
# Poisson
mod1<-svyglm(start.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 28

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.em.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.em.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- start.info.support.tot
# Poisson
mod1<-svyglm(start.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 29

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.info.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.info.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- start.tan.support.tot
# Poisson
mod1<-svyglm(start.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 30

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.tan.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.tan.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- start.any.support.tot
# Poisson
mod1<-svyglm(start.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 31

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.any.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.any.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- maintain.em.support.tot
# Poisson
mod1<-svyglm(maintain.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 32

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.em.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.em.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- maintain.info.support.tot
# Poisson
mod1<-svyglm(maintain.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 33

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.info.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.info.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- maintain.tan.support.tot
# Poisson
mod1<-svyglm(maintain.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 34

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.tan.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.tan.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- maintain.any.support.tot
# Poisson
mod1<-svyglm(maintain.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 35

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.any.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.any.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- former.em.support.tot
# Poisson
mod1<-svyglm(former.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 36

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.em.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.em.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- former.info.support.tot
# Poisson
mod1<-svyglm(former.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 37

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.info.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.info.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- former.tan.support.tot
# Poisson
mod1<-svyglm(former.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 38

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.tan.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.tan.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- former.any.support.tot
# Poisson
mod1<-svyglm(former.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 39

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.any.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.any.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---Full sample
#--- new.em.support.tot
# Poisson
mod1<-svyglm(new.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 40

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.em.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.em.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- new.info.support.tot
# Poisson
mod1<-svyglm(new.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 41

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.info.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.info.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- new.tan.support.tot
# Poisson
mod1<-svyglm(new.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 42

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.tan.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.tan.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- new.any.support.tot
# Poisson
mod1<-svyglm(new.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 43

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.any.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.any.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- stop.risk.and.support.tot
# Poisson
mod1<-svyglm(stop.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 44

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.and.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.risk.and.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- stop.risk.not.support.tot
# Poisson
mod1<-svyglm(stop.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))


v <- 45

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.not.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.risk.not.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- stop.support.not.risk.tot
# Poisson
mod1<-svyglm(stop.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 46

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.support.not.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.support.not.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- stop.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(stop.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 47

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.and.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.risk.and.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- stop.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(stop.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 48

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.not.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.risk.not.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- stop.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(stop.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 49

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.support.not.risk.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~stop.support.not.risk.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---Full sample
#--- start.risk.and.support.tot
# Poisson
mod1<-svyglm(start.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 50

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.and.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.risk.and.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- start.risk.not.support.tot
# Poisson
mod1<-svyglm(start.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 51

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.not.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.risk.not.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- start.support.not.risk.tot
# Poisson
mod1<-svyglm(start.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 52

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.support.not.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.support.not.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- start.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(start.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 53

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.and.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.risk.and.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- start.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(start.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 54

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.not.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.risk.not.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- start.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(start.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 55

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.support.not.risk.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~start.support.not.risk.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int

















#---Full sample
#--- maintain.risk.and.support.tot
# Poisson
mod1<-svyglm(maintain.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 56

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.and.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.risk.and.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- maintain.risk.not.support.tot
# Poisson
mod1<-svyglm(maintain.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 57

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.not.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.risk.not.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- maintain.support.not.risk.tot
# Poisson
mod1<-svyglm(maintain.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 58

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.support.not.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.support.not.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- maintain.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(maintain.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 59

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- maintain.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(maintain.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 60

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- maintain.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(maintain.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 61

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int












#---Full sample
#--- former.risk.and.support.tot
# Poisson
mod1<-svyglm(former.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 62

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.and.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.risk.and.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- former.risk.not.support.tot
# Poisson
mod1<-svyglm(former.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 63

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.not.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.risk.not.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- former.support.not.risk.tot
# Poisson
mod1<-svyglm(former.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 64

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.support.not.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.support.not.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- former.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(former.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 65

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.and.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.risk.and.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- former.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(former.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 66

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.not.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.risk.not.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- former.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(former.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 67

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.support.not.risk.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~former.support.not.risk.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int













#---Full sample
#--- new.risk.and.support.tot
# Poisson
mod1<-svyglm(new.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 68

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.and.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.risk.and.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- new.risk.not.support.tot
# Poisson
mod1<-svyglm(new.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 69

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.not.support.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.risk.not.support.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- new.support.not.risk.tot
# Poisson
mod1<-svyglm(new.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 70

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.support.not.risk.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.support.not.risk.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- new.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(new.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 71

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.and.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.risk.and.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---Full sample
#--- new.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(new.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 72

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.not.support.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.risk.not.support.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- new.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(new.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 73

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.support.not.risk.recent.tot,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~new.support.not.risk.recent.tot,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- alters
# Poisson
mod1<-svyglm(alters~Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 74

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~alters,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---Full sample
#--- alters.f
# Poisson
mod1<-svyglm(alters.f~Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 75

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters.f,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~alters.f,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---Full sample
#--- alters.b
# Poisson
mod1<-svyglm(alters.b~Assignment,family=quasipoisson(),
              design=designR)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 76

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters.b,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~alters.b,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- density_weak
# Gaussian
mod1<-svyglm(density_weak~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 77
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)


#---Cross Wave
m.match <- svyby(~density_weak,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~density_weak,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full sample
#--- density_medium
# Gaussian
mod1<-svyglm(density_medium~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 78
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)



#---Cross Wave
m.match <- svyby(~density_medium,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~density_medium,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---Full sample
#--- density_strong
# Gaussian
mod1<-svyglm(density_strong~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 79
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1] <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)




#---Cross Wave
m.match <- svyby(~density_strong,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~density_strong,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---Full sample
#--- components_weak
# Gaussian
mod1<-svyglm(components_weak~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 80
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1] <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)






#---Cross Wave
m.match <- svyby(~components_weak,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~components_weak,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---Full sample
#--- components_medium
# Gaussian
mod1<-svyglm(components_medium~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 81
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1] <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)





#---Cross Wave
m.match <- svyby(~components_medium,~Assignment,designR, svymean)
s.match <- sqrt(svyby(~components_medium,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---Full sample
#--- components_strong
# Gaussian
mod1<-svyglm(components_strong~Assignment,family=gaussian(link = "identity"),
              design=designR)
v <- 82
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.all[v,1] <- net.matched.vars[v,1]
net.churn.matched.stats.all[v,6] <- round(beta[2], 2)
net.churn.matched.stats.all[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.all[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.all[v,9] <- round(ci[2,2], 2)



#---Cross Wave
m.match <- svyby(~components_strong,~Assignment,designR, svymean)
         s.match <- sqrt(svyby(~components_strong,~Assignment,designR, svyvar))

#---Recycle predictions
tmp1<-MyDataR
tmp1$Assignment[]<-1

tmp2<-MyDataR
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR)
svymean(~s12,designR)

mean(s11)
mean(s12)

net.churn.matched.stats.all[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.all[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.all[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.all[v,5] <- round(s.match[2,2], 2) #sd.base.int



#---Full Sample
#---Add In Effect Sizes



m<-svyby(~dropped.alter.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~dropped.alter.tot,designR,na.rm=T))
net.churn.matched.stats.all[1,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.alter.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.alter.tot,designR,na.rm=T))
net.churn.matched.stats.all[2,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~retained.alter.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~retained.alter.tot,designR,na.rm=T))
net.churn.matched.stats.all[3,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.drink.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.drink.tot,designR,na.rm=T))
net.churn.matched.stats.all[4,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.drug.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.drug.tot,designR,na.rm=T))
net.churn.matched.stats.all[5,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[6,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[7,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.drink.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.drink.tot,designR,na.rm=T))
net.churn.matched.stats.all[8,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.drug.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.drug.tot,designR,na.rm=T))
net.churn.matched.stats.all[9,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[10,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[11,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.drink.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.drink.tot,designR,na.rm=T))
net.churn.matched.stats.all[12,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.drug.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.drug.tot,designR,na.rm=T))
net.churn.matched.stats.all[13,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[14,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[15,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.drink.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.drink.tot,designR,na.rm=T))
net.churn.matched.stats.all[16,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.drug.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.drug.tot,designR,na.rm=T))
net.churn.matched.stats.all[17,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[18,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[19,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.drink.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.drink.tot,designR,na.rm=T))
net.churn.matched.stats.all[20,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.drug.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.drug.tot,designR,na.rm=T))
net.churn.matched.stats.all[21,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[22,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[23,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.em.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.em.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[24,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.info.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.info.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[25,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.tan.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.tan.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[26,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.any.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.any.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[27,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.em.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.em.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[28,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.info.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.info.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[29,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.tan.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.tan.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[30,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.any.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.any.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[31,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.em.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.em.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[32,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.info.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.info.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[33,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.aod.more.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.aod.more.tot,designR,na.rm=T))
net.churn.matched.stats.all[34,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.any.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.any.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[35,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.em.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.em.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[36,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.info.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.info.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[37,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.tan.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.tan.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[38,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.any.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.any.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[39,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.em.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.em.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[40,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.info.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.info.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[41,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.tan.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.tan.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[42,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.any.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.any.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[43,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.and.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.and.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[44,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.not.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.not.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[45,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.support.not.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.support.not.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[46,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.and.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.and.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[47,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.not.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.not.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[48,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.support.not.risk.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.support.not.risk.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[49,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.and.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.and.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[50,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.not.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.not.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[51,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.support.not.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.support.not.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[52,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.and.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.and.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[53,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.not.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.not.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[54,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.support.not.risk.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~start.support.not.risk.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[55,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.and.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.and.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[56,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.not.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.not.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[57,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.support.not.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.support.not.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[58,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.and.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[59,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.not.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[60,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.support.not.risk.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[61,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.and.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.and.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[62,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.not.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.not.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[63,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.support.not.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.support.not.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[64,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.and.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.and.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[65,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.not.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.not.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[66,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.support.not.risk.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~former.support.not.risk.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[67,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.and.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.and.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[68,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.not.support.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.not.support.tot,designR,na.rm=T))
net.churn.matched.stats.all[69,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.support.not.risk.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.support.not.risk.tot,designR,na.rm=T))
net.churn.matched.stats.all[70,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.and.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.and.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[71,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.not.support.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.not.support.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[72,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.support.not.risk.recent.tot,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~new.support.not.risk.recent.tot,designR,na.rm=T))
net.churn.matched.stats.all[73,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~alters,designR,na.rm=T))
net.churn.matched.stats.all[74,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters.f,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~alters.f,designR,na.rm=T))
net.churn.matched.stats.all[75,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters.b,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~alters.b,designR,na.rm=T))
net.churn.matched.stats.all[76,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_weak,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~density_weak,designR,na.rm=T))
net.churn.matched.stats.all[77,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_medium,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~density_medium,designR,na.rm=T))
net.churn.matched.stats.all[78,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_strong,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~density_strong,designR,na.rm=T))
net.churn.matched.stats.all[79,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_weak,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~components_weak,designR,na.rm=T))
net.churn.matched.stats.all[80,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_medium,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~components_medium,designR,na.rm=T))
net.churn.matched.stats.all[81,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_strong,~Assignment,designR, svymean,na.rm=T)
v<-sqrt(svyvar(~components_strong,designR,na.rm=T))
net.churn.matched.stats.all[82,10] <-round((m[2,2]-m[1,2])/v, 2)


write.csv( net.churn.matched.stats.all, file='net.churn.match.stats.all.csv')


net.churn.matched.stats.srht<-matrix( nrow= 82, ncol=10)
colnames(net.churn.matched.stats.srht) <- c("varname", "mean.con", "sd.con", "mean.int", "sd.int", "est", "p val", "95 CI L", "95 CI H", "eff size")







#---SRHT only
#--- dropped.alter.tot
# Poisson
mod1<-svyglm(dropped.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 1

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~dropped.alter.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~dropped.alter.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- new.alter.tot
# Poisson
mod1<-svyglm(new.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 2

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.alter.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.alter.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int



#---SRHT only
#--- retained.alter.tot
# Poisson
mod1<-svyglm(retained.alter.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 3

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~retained.alter.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~retained.alter.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- stop.drink.tot
# Poisson
mod1<-svyglm(stop.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 4

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.drink.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.drink.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- stop.drug.tot
# Poisson
mod1<-svyglm(stop.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 5

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.drug.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.drug.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- stop.aod.more.tot
# Poisson
mod1<-svyglm(stop.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 6

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.aod.more.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.aod.more.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- stop.any.risk.tot
# Poisson
mod1<-svyglm(stop.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 7

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.any.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.any.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---SRHT only
#--- start.drink.tot
# Poisson
mod1<-svyglm(start.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 8

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.drink.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.drink.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- start.drug.tot
# Poisson
mod1<-svyglm(start.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 9

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.drug.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.drug.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- start.aod.more.tot
# Poisson
mod1<-svyglm(start.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 10

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.aod.more.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.aod.more.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- start.any.risk.tot
# Poisson
mod1<-svyglm(start.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 11

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.any.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.any.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- maintain.drink.tot
# Poisson
mod1<-svyglm(maintain.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 12

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.drink.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.drink.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- maintain.drug.tot
# Poisson
mod1<-svyglm(maintain.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 13

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.drug.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.drug.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- maintain.aod.more.tot
# Poisson
mod1<-svyglm(maintain.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 14

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.aod.more.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.aod.more.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- maintain.any.risk.tot
# Poisson
mod1<-svyglm(maintain.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 15

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.any.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.any.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- former.drink.tot
# Poisson
mod1<-svyglm(former.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 16

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.drink.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.drink.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- former.drug.tot
# Poisson
mod1<-svyglm(former.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 17

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.drug.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.drug.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- former.aod.more.tot
# Poisson
mod1<-svyglm(former.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 18

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.aod.more.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.aod.more.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- former.any.risk.tot
# Poisson
mod1<-svyglm(former.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 19

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.any.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.any.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---SRHT only
#--- new.drink.tot
# Poisson
mod1<-svyglm(new.drink.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 20

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.drink.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.drink.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- new.drug.tot
# Poisson
mod1<-svyglm(new.drug.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 21

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.drug.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.drug.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- new.aod.more.tot
# Poisson
mod1<-svyglm(new.aod.more.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 22

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.aod.more.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.aod.more.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- new.any.risk.tot
# Poisson
mod1<-svyglm(new.any.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 23

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.any.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.any.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int























#---SRHT only
#--- stop.em.support.tot
# Poisson
mod1<-svyglm(stop.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 24

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.em.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.em.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- stop.info.support.tot
# Poisson
mod1<-svyglm(stop.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 25

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.info.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.info.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- stop.tan.support.tot
# Poisson
mod1<-svyglm(stop.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 26

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.tan.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.tan.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- stop.any.support.tot
# Poisson
mod1<-svyglm(stop.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 27

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.any.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.any.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---SRHT only
#--- start.em.support.tot
# Poisson
mod1<-svyglm(start.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 28

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.em.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.em.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- start.info.support.tot
# Poisson
mod1<-svyglm(start.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 29

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.info.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.info.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- start.tan.support.tot
# Poisson
mod1<-svyglm(start.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 30

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.tan.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.tan.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- start.any.support.tot
# Poisson
mod1<-svyglm(start.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 31

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.any.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.any.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- maintain.em.support.tot
# Poisson
mod1<-svyglm(maintain.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 32

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.em.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.em.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- maintain.info.support.tot
# Poisson
mod1<-svyglm(maintain.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 33

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.info.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.info.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- maintain.tan.support.tot
# Poisson
mod1<-svyglm(maintain.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 34

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.tan.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.tan.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- maintain.any.support.tot
# Poisson
mod1<-svyglm(maintain.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 35

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.any.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.any.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- former.em.support.tot
# Poisson
mod1<-svyglm(former.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 36

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.em.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.em.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- former.info.support.tot
# Poisson
mod1<-svyglm(former.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 37

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.info.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.info.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- former.tan.support.tot
# Poisson
mod1<-svyglm(former.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 38

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.tan.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.tan.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- former.any.support.tot
# Poisson
mod1<-svyglm(former.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 39

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.any.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.any.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---SRHT only
#--- new.em.support.tot
# Poisson
mod1<-svyglm(new.em.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 40

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.em.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.em.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- new.info.support.tot
# Poisson
mod1<-svyglm(new.info.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 41

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.info.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.info.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- new.tan.support.tot
# Poisson
mod1<-svyglm(new.tan.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 42

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.tan.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.tan.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- new.any.support.tot
# Poisson
mod1<-svyglm(new.any.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 43

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.any.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.any.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- stop.risk.and.support.tot
# Poisson
mod1<-svyglm(stop.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 44

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.and.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.risk.and.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- stop.risk.not.support.tot
# Poisson
mod1<-svyglm(stop.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 45

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.not.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.risk.not.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- stop.support.not.risk.tot
# Poisson
mod1<-svyglm(stop.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 46

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.support.not.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.support.not.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- stop.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(stop.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 47

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.risk.and.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- stop.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(stop.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 48

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.risk.not.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- stop.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(stop.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 49

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~stop.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~stop.support.not.risk.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int











#---SRHT only
#--- start.risk.and.support.tot
# Poisson
mod1<-svyglm(start.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 50

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.and.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.risk.and.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- start.risk.not.support.tot
# Poisson
mod1<-svyglm(start.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 51

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.not.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.risk.not.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- start.support.not.risk.tot
# Poisson
mod1<-svyglm(start.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 52

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.support.not.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.support.not.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- start.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(start.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 53

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.risk.and.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- start.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(start.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 54

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.risk.not.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- start.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(start.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 55

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~start.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~start.support.not.risk.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int

















#---SRHT only
#--- maintain.risk.and.support.tot
# Poisson
mod1<-svyglm(maintain.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 56

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.and.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.risk.and.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- maintain.risk.not.support.tot
# Poisson
mod1<-svyglm(maintain.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 57

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.not.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.risk.not.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- maintain.support.not.risk.tot
# Poisson
mod1<-svyglm(maintain.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 58

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.support.not.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.support.not.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- maintain.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(maintain.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 59

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- maintain.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(maintain.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 60

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- maintain.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(maintain.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 61

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int












#---SRHT only
#--- former.risk.and.support.tot
# Poisson
mod1<-svyglm(former.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 62

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.and.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.risk.and.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- former.risk.not.support.tot
# Poisson
mod1<-svyglm(former.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 63

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.not.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.risk.not.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- former.support.not.risk.tot
# Poisson
mod1<-svyglm(former.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 64

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.support.not.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.support.not.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- former.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(former.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 65

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.risk.and.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- former.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(former.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 66

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.risk.not.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- former.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(former.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 67

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~former.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~former.support.not.risk.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int













#---SRHT only
#--- new.risk.and.support.tot
# Poisson
mod1<-svyglm(new.risk.and.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 68

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.and.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.risk.and.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- new.risk.not.support.tot
# Poisson
mod1<-svyglm(new.risk.not.support.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 69

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.not.support.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.risk.not.support.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- new.support.not.risk.tot
# Poisson
mod1<-svyglm(new.support.not.risk.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 70

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.support.not.risk.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.support.not.risk.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- new.risk.and.support.recent.tot
# Poisson
mod1<-svyglm(new.risk.and.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 71

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.risk.and.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int




#---SRHT only
#--- new.risk.not.support.recent.tot
# Poisson
mod1<-svyglm(new.risk.not.support.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 72

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.risk.not.support.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int






#---SRHT only
#--- new.support.not.risk.recent.tot
# Poisson
mod1<-svyglm(new.support.not.risk.recent.tot~alters.b+Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[3])

ci <- exp(confint.default(mod1))

v <- 73

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[3,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[3,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[3,2], 2)

#---Cross Wave
m.match <- svyby(~new.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~new.support.not.risk.recent.tot,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- alters
# Poisson
mod1<-svyglm(alters~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 74

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~alters,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int









#---SRHT only
#--- alters.f
# Poisson
mod1<-svyglm(alters.f~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 75

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters.f,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~alters.f,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT only
#--- alters.b
# Poisson
mod1<-svyglm(alters.b~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 76

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~alters.b,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~alters.b,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int












#---SRHT only
#--- density_weak
# Gaussian
mod1<-svyglm(density_weak~Assignment,family=gaussian(link = "identity"),
              design=designR.SRHT)
v <- 77
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta[2], 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)


#---Cross Wave
m.match <- svyby(~density_weak,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~density_weak,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---SRHT only
#--- density_medium
# Gaussian
mod1<-svyglm(density_medium~Assignment,family=gaussian(link = "identity"),
              design=designR.SRHT)
v <- 78
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta[2], 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)



#---Cross Wave
m.match <- svyby(~density_medium,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~density_medium,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT only
#--- density_strong
# Gaussian
mod1<-svyglm(density_strong~Assignment,family=gaussian(link = "identity"),
              design=designR.SRHT)
v <- 79
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])


beta <- coef(mod1)
confint.default(mod1)

ci <- confint.default(mod1)

net.churn.matched.stats.srht[v,1] <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta[2], 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)




#---Cross Wave
m.match <- svyby(~density_strong,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~density_strong,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int





#---SRHT Only
#--- components_weak
# Poisson
mod1<-svyglm(components_weak~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 80

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~components_weak,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~components_weak,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT Only
#--- components_medium
# Poisson
mod1<-svyglm(components_medium~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 81

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~components_medium,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~components_medium,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int







#---SRHT Only
#--- components_strong
# Poisson
mod1<-svyglm(components_strong~Assignment,family=quasipoisson(),
              design=designR.SRHT)
summ <- summary(mod1)
beta <- coef(mod1)
beta.exp <- exp(beta[2])

ci <- exp(confint.default(mod1))

v <- 82

net.churn.matched.stats.srht[v,1]  <- net.matched.vars[v,1]
net.churn.matched.stats.srht[v,6] <- round(beta.exp, 2)
net.churn.matched.stats.srht[v,7] <- round(summ$coefficients[2,4], 3)
net.churn.matched.stats.srht[v,8] <- round(ci[2,1], 2)
net.churn.matched.stats.srht[v,9] <- round(ci[2,2], 2)

#---Cross Wave
m.match <- svyby(~components_strong,~Assignment,designR.SRHT, svymean)
s.match <- sqrt(svyby(~components_strong,~Assignment,designR.SRHT, svyvar))

#---Recycle predictions
tmp1<-MyDataR.SRHT
tmp1$Assignment[]<-1

tmp2<-MyDataR.SRHT
tmp2$Assignment[]<-0

s11<-predict(mod1, type="response",newdata=tmp1)
s12<-predict(mod1, type="response",newdata=tmp2)

svymean(~s11,designR.SRHT)
svymean(~s12,designR.SRHT)

mean(s11)
mean(s12)

net.churn.matched.stats.srht[v,2] <- round(m.match[1,2], 2) #mean.base.con
net.churn.matched.stats.srht[v,3] <- round(s.match[1,2], 2) #sd.base.con

net.churn.matched.stats.srht[v,4] <- round(m.match[2,2], 2) #mean.base.int
net.churn.matched.stats.srht[v,5] <- round(s.match[2,2], 2) #sd.base.int








#---Full Sample
#---Add In Effect Sizes



m<-svyby(~dropped.alter.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~dropped.alter.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[1,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.alter.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.alter.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[2,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~retained.alter.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~retained.alter.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[3,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.drink.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.drink.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[4,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.drug.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.drug.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[5,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[6,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[7,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.drink.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.drink.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[8,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.drug.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.drug.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[9,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[10,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[11,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.drink.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.drink.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[12,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.drug.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.drug.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[13,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[14,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[15,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.drink.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.drink.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[16,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.drug.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.drug.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[17,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[18,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[19,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.drink.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.drink.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[20,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.drug.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.drug.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[21,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[22,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[23,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.em.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.em.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[24,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.info.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.info.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[25,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.tan.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.tan.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[26,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.any.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.any.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[27,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.em.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.em.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[28,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.info.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.info.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[29,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.tan.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.tan.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[30,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.any.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.any.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[31,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.em.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.em.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[32,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.info.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.info.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[33,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.aod.more.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.aod.more.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[34,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.any.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.any.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[35,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.em.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.em.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[36,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.info.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.info.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[37,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.tan.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.tan.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[38,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.any.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.any.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[39,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.em.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.em.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[40,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.info.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.info.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[41,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.tan.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.tan.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[42,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.any.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.any.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[43,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.and.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.and.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[44,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.not.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.not.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[45,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.support.not.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.support.not.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[46,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.and.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[47,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.risk.not.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[48,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~stop.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~stop.support.not.risk.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[49,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.and.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.and.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[50,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.not.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.not.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[51,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.support.not.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.support.not.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[52,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.and.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[53,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.risk.not.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[54,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~start.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~start.support.not.risk.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[55,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.and.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.and.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[56,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.not.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.not.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[57,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.support.not.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.support.not.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[58,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.and.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[59,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.risk.not.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[60,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~maintain.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~maintain.support.not.risk.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[61,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.and.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.and.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[62,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.not.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.not.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[63,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.support.not.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.support.not.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[64,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.and.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[65,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.risk.not.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[66,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~former.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~former.support.not.risk.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[67,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.and.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.and.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[68,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.not.support.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.not.support.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[69,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.support.not.risk.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.support.not.risk.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[70,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.and.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.and.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[71,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.risk.not.support.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.risk.not.support.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[72,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~new.support.not.risk.recent.tot,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~new.support.not.risk.recent.tot,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[73,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~alters,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[74,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters.f,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~alters.f,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[75,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~alters.b,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~alters.b,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[76,10] <-round((m[2,2]-m[1,2])/v, 2)


m<-svyby(~density_weak,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~density_weak,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[77,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_medium,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~density_medium,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[78,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~density_strong,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~density_strong,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[79,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_weak,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~components_weak,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[80,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_medium,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~components_medium,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[81,10] <-round((m[2,2]-m[1,2])/v, 2)

m<-svyby(~components_strong,~Assignment,designR.SRHT, svymean,na.rm=T)
v<-sqrt(svyvar(~components_strong,designR.SRHT,na.rm=T))
net.churn.matched.stats.srht[82,10] <-round((m[2,2]-m[1,2])/v, 2)


write.csv( net.churn.matched.stats.srht, file='net.churn.matched.stats.srht.csv')

```

